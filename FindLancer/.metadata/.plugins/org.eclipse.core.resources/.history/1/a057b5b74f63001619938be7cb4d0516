package br.com.findlancer.sql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList; 

import br.com.findlancer.model.Categorias;

public class CategoriasDAO {

	Connection conexaoDB= Conexao.conectar();
	public ArrayList<Categorias> popularCategorias(){
		ArrayList<Categorias> listaCategorias = null;
		try {
			//List categorias 
			listaCategorias = new ArrayList<Categorias>();

			
			//Comando realizando o select dos campos de categorias
			String sql ="SELECT idCategoria,descricao FROM categorias" ;
			
			//Preparando o statament 
			PreparedStatement stmt = conexaoDB.prepareStatement(sql);
			//Result rs recebendo resultados da query
			ResultSet rs =stmt.executeQuery();
			
			//While para capturar todos os valores resultados da query e armazenar no List<Categorias>
			while(rs.next()){
				//Instanciando objeto da classe categorias
				Categorias categoria = new Categorias();
				categoria.setIdCategoria(rs.getInt(1));
				categoria.setDescricao(rs.getString(2));
				
				//Armazenando objeto categoria dentro da lista
				listaCategorias.add(categoria);
			}
			
			System.out.println("Query categorias ok.");
			
		} catch (SQLException e) {
			System.out.println("Query categorias erro.");

		}
		
		return listaCategorias;
	}
}

