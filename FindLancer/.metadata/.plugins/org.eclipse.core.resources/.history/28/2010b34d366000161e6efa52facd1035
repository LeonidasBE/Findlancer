package br.com.findlancer.sql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import br.com.findlancer.entidades.Categorias;
import br.com.findlancer.entidades.Empresas;

public class CategoriasDAO {

	Connection conexaoDB= Conexao.conectar();
	public ArrayList<String> popularCategorias(){
		ArrayList<Categorias> listaCategorias = null;
		try {
			//List categorias 
			listaCategorias = new ArrayList<Categorias>();
			
			//Comando realizando o select dos campos de categorias
			String sql ="SELECT idCategoria,descricao FROM categorias" ;
			
			//Preparando o statament 
			PreparedStatement stmt = conexaoDB.prepareStatement(sql);
			//Result rs recebendo resultados da query
			ResultSet rs =stmt.executeQuery();
			
			//While para capturar todos os valores resultados da query e armazenar no List<Categorias>
			while(rs.next()){
				
				//Instancia objeto to tipo categoria
				Categorias categoria = new Categorias();
				
				//Captura os valores resultados da query
				categoria.setIdCategoria(rs.getInt(1));
				categoria.setDescricao(rs.getString(2));				
				
				//Adiciona categoria instanciada no list
				listaCategorias.add(categoria);
				
			}
			
			System.out.println("Query categorias ok.");
			
		} catch (SQLException e) {
			System.out.println("Query categorias erro.");

		}
		
		return listaCategorias;
	}
}

