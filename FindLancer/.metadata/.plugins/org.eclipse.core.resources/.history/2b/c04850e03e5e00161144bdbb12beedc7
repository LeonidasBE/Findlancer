package br.com.findlancer.sql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class LoginDAO {
	
	Connection conexaoDB = Conexao.conectar();

    public int logar(String email,String senha){
    	int idUsuario = 0;
    	//String sql ="select idfree as id from freelancers where email = ? and senha = ?";
		String sql ="(SELECT freelancers.idFree FROM freelancers WHERE where freelancers.email = ? and freelancers.senha = ? = LIMIT 1)"+
				"UNION (SELECT empresas.idEmpresa as empresa FROM empresas WHERE empresas.email=? and empresas.senha = ? )"; 
			
			try {
			PreparedStatement statement = conexaoDB.prepareStatement(sql);
			statement.setString(1, email);
			statement.setString(2, senha);
			statement.setString(3, email);
			statement.setString(4, senha);

			
			ResultSet resultado = statement.executeQuery();
			
			if(resultado.next()){
				idUsuario=resultado.getInt(1);
				System.out.println(resultado.getMetaData().getColumnName(1));
			}
			
			System.out.println("Login verificado.");
		} catch (SQLException e) {
			System.out.println("Erro ao verificar login.");
		}
		
		return idUsuario;
    }
	
    public String teste(int id ){
    	/*String nome="erro";
    	String sql ="select nome from freelancers where idFree = ? ";
		try {
			PreparedStatement statement = conexaoDB.prepareStatement(sql);
			statement.setInt(1, id);
			
			ResultSet resultado = statement.executeQuery();
			
			if(resultado.next()){
				nome=resultado.getString(1);
			}
			
			System.out.println("Login verificado.");
		} catch (SQLException e) {
			System.out.println("Erro ao verificar login.");
		}
    	
    	return nome;*/
    	
    	return null;
    }
	
}
