package br.com.findlancer.sql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import br.com.findlancer.model.Enderecos;

public class EnderecosDAO {

	Connection conexaoDB = Conexao.conectar();
	
	public void cadastrarEndereco(Enderecos endereco){
		//Comando para o insert no banco
		String sql="INSERT INTO enderecos (numero, cep, bairro, fk_cidade, nome_Rua) VALUES ( ?, ?, ?, ?, ?);";
		try {
			//Preparando a query
			PreparedStatement stmt = conexaoDB.prepareStatement(sql);
			
			//Atribuir os parametros da query
			stmt.setInt(1, endereco.getNumeroRua());
			stmt.setInt(2, endereco.getCep());
			stmt.setString(3, endereco.getBairro());
			stmt.setInt(4, endereco.getFk_cidade());
			stmt.setString(5, endereco.getNomeRua());
			
			//executar o insert 
			stmt.execute();
			
			System.out.println("Endereco cadastrado");
		} catch (SQLException e) {
			System.out.println("Endereco nao cadastrado");
			 
		}
		
	}
	
	
	public int retornarFk(){
		int FkEnd=0;
		//Comando query 
		String sql="select idEndereco from enderecos ORDER by  idEndereco desc limit 1";
		
		//try para tentar executar a query
		try {
			//preparar a query
			PreparedStatement stmt = conexaoDB.prepareStatement(sql);
			//Executando e armazenando da query
			ResultSet resultado= stmt.executeQuery();
			
			//While para receber resultado da query
			while(resultado.next()){
				FkEnd=resultado.getInt(1);
			}
		} catch (SQLException e) {
			 
		}
		
		
		return FkEnd;
	}
}
