package br.com.findlancer.sql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class LoginDAO {
	
	Connection conexaoDB = Conexao.conectar();

    public int logar(String email,String senha){
    	int idUsuario = 0;
    	String sqlFreela ="select idfree as id from freelancers where email = ? and senha = ?";
		
    	//Método para verificar o freelancer
    	 idUsuario=logarSelectMétodo(sqlFreela, email, senha);
    	
    	 if(idUsuario==0){
    		String sqlEmpresa="SELECT empresas.idEmpresa FROM empresas WHERE empresas.email =? and empresas.senha = ? ";
    		idUsuario=logarSelectMétodo(sqlEmpresa, email, senha);
    	}
		
		return idUsuario;
    }
	
    public String teste(int id ){
    	/*String nome="erro";
    	String sql ="select nome from freelancers where idFree = ? ";
		try {
			PreparedStatement statement = conexaoDB.prepareStatement(sql);
			statement.setInt(1, id);
			
			ResultSet resultado = statement.executeQuery();
			
			if(resultado.next()){
				nome=resultado.getString(1);
			}
			
			System.out.println("Login verificado.");
		} catch (SQLException e) {
			System.out.println("Erro ao verificar login.");
		}
    	
    	return nome;*/
    	
    	return null;
    }
    
    private int logarSelectMétodo(String sql,String email,String senha){
    	int idUsuario=0;
    	try {
			PreparedStatement statement = conexaoDB.prepareStatement(sql);
			statement.setString(1, email);
			statement.setString(2, senha);
			
			ResultSet resultado = statement.executeQuery();
			
			if(resultado.next()){
				idUsuario=resultado.getInt(1);
			}
			
			System.out.println("Login verificado.");
			
		} catch (SQLException e) {
			
			System.out.println("Erro ao verificar login.");
		}
    
    	return idUsuario;
    	
    }
	
}
